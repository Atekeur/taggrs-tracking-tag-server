___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1.1,
  "securityGroups": [],
  "displayName": "TAGGRS tracking tag - server side",
  "brand": {
    "id": "taggrs_server",
    "displayName": "Taggrs",
    "categories": ["ANALYTICS"],
    "thumbnail": "data:image/png;base64,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
  },
  "description": "Meet je server page views requests",
  "containerContexts": [
    "SERVER"
  ]
}

___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "container_id",
    "displayName": "Container Identifier",
    "simpleValueType": true,
    "help": "Je kan je Container Identifier vinden in je Taggrs Container",
    "valueValidators": [
      {
        "type": "STRING_LENGTH",
        "args": [
          10,
          10
        ]
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "event_name",
    "displayName": "Event name",
    "simpleValueType": true
  }
]


___SANDBOXED_JS_FOR_SERVER___

// Geef hier uw templatecode op.
const log = require('logToConsole');
const queryPermission = require('queryPermission');
const sendHttpRequest = require('sendHttpRequest');
const JSON = require('JSON');

const url = 'https://app.taggrs.io/api/v1/requests/server';
const data_url = '?container_id=' + data.container_id + '&event_name=' + data.event_name;
const total_url = url + data_url;

log(data);
log(total_url);


  log('Permission granted');
  sendHttpRequest(total_url, (statusCode, headers, response) => {
    log(statusCode);
    if(statusCode == '200'){
       data.gtmOnSuccess();
       } else{
      data.gtmOnFailure();
    }
  return response;
  
}, {method: 'GET', timeout: 2000});
  

// Roep data.gtmOnSuccess aan wanneer de tag is voltooid.


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://app.taggrs.io/api/v1/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 28-3-2023 12:04:14


